var userInfo=navigator.userAgent.toUpperCase(),isIE=userInfo.indexOf("MSIE")>-1,isIE6=isIE&&userInfo.indexOf("MSIE 6.0")>-1,isFF=!isIE&&userInfo.indexOf("FIREFOX")>-1;document.writeln('<script type="text/javascript" src="/public_js/UploadFile.js"><\/script>');function CheckImage(){this.AllowExt="jpg,gif,swf";this.AllowImgHeight=this.AllowImgWidth=this.AllowImgFileSize=0;this.IsJingQueSize=false}CheckImage.prototype.check=function(b){b.setAttribute("isChecked","false");CheckImage.init(b,this)};
CheckImage.isChecked=function(b){b=b.getAttribute("isChecked");return!b||b=="true"};
CheckImage.init=function(b,d){var c=false;if(d.AllowExt!="0")if(c=b.value,c=c.substr(c.lastIndexOf(".")+1).toLowerCase())if(d.AllowExt.toLowerCase().indexOf(c)==-1)return alert("请选择正确的文件格式！"),false;else c=c.indexOf("swf")==-1;else return alert("请选择文件！"),false;if(c)if(d.AllowImgFileSize>0||d.AllowImgWidth>0||d.AllowImgHeight>0){var a=new Image;if(isFF){var e=b.files[0];a.src=e.getAsDataURL();a.onload=function(){if(a.complete)return CheckImage.doit(d,b,e.fileSize,a.width,a.height)}}else isIE6?(a.onreadystatechange=
function(){if(a.readyState=="complete")return CheckImage.doit(d,b,a.fileSize,a.width,a.height)},a.src=b.value):new UploadFile(b,{action:"/uploadFile.do",onFinish:function(c){c instanceof Array&&c.length>0?(a.src=c[0].src,a.onreadystatechange=function(){if(a.readyState=="complete")return CheckImage.doit(d,b,a.fileSize,a.width,a.height)}):alert("上传文件出现错误！")}})}else b.setAttribute("isChecked","true");else b.setAttribute("isChecked","true")};
CheckImage.doit=function(b,d,c,a,e){a=b.AllowImgFileSize;if(a>0&&a*1024<c)return alert("最大上传"+a+"K的文件！"),false;c=b.AllowImgHeight;if(c>0)if(b.IsJingQueSize){if(c!=e)return alert("只能上传高度为"+c+"px的图片!"),false}else if(c<e)return alert("最大能上传高度为"+c+"px的图片!"),false;a=b.AllowImgWidth;if(a>0)if(b.IsJingQueSize){if(a!=e)return alert("只能上传宽度为"+a+"px的图片!"),false}else if(c<e)return alert("最大能上传宽度为"+a+"px的图片!"),false;d.setAttribute("isChecked","true")};
