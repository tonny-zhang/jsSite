(function(n,c,o){var k=c.event,l;k.special.smartresize={setup:function(){c(this).bind("resize",k.special.smartresize.handler)},teardown:function(){c(this).unbind("resize",k.special.smartresize.handler)},handler:function(a,b){var d=this,e=arguments;a.type="smartresize";l&&clearTimeout(l);l=setTimeout(function(){jQuery.event.handle.apply(d,e)},b==="execAsap"?0:100)}};c.fn.smartresize=function(a){return a?this.bind("smartresize",a):this.trigger("smartresize",["execAsap"])};c.Mason=function(a,b){this.element=
c(b);this._create(a);this._init()};var f=["position","height"];c.Mason.settings={isResizable:true,isAnimated:false,animationOptions:{queue:false,duration:500},gutterWidth:0,isRTL:false,isFitWidth:false};c.Mason.prototype={_filterFindBricks:function(a){var b=this.options.itemSelector;return!b?a:a.filter(b).add(a.find(b))},_getBricks:function(a){return this._filterFindBricks(a).css({position:"absolute"}).addClass("masonry-brick")},_create:function(a){this.options=c.extend(true,{},c.Mason.settings,a);
this.styleQueue=[];this.reloadItems();a=this.element[0].style;this.originalStyle={};for(var b=0,d=f.length;b<d;b++){var e=f[b];this.originalStyle[e]=a[e]||""}this.element.css({position:"relative"});this.horizontalDirection=this.options.isRTL?"right":"left";this.offset={};a=c(document.createElement("div"));this.element.prepend(a);this.offset.y=Math.round(a.position().top);this.options.isRTL?(a.css({"float":"right",display:"inline-block"}),this.offset.x=Math.round(this.element.outerWidth()-a.position().left)):
this.offset.x=Math.round(a.position().left);a.remove();var g=this;setTimeout(function(){g.element.addClass("masonry")},0);this.options.isResizable&&c(n).bind("smartresize.masonry",function(){g.resize()})},_init:function(a){this._getColumns("masonry");this._reLayout(a)},option:function(a){if(c.isPlainObject(a))this.options=c.extend(true,this.options,a)},layout:function(a,b){for(var d,e,g,m,j,i,h=0,f=a.length;h<f;h++)if(d=c(a[h]),e=Math.ceil(d.outerWidth(true)/this.columnWidth),e=Math.min(e,this.cols),
e===1)this._placeBrick(d,this.colYs);else{g=this.cols+1-e;m=[];for(i=0;i<g;i++)j=this.colYs.slice(i,i+e),m[i]=Math.max.apply(Math,j);this._placeBrick(d,m)}h={};h.height=Math.max.apply(Math,this.colYs)-this.offset.y;if(this.options.isFitWidth)h.width=this.cols*this.columnWidth-this.options.gutterWidth;this.styleQueue.push({$el:this.element,style:h});d=!this.isLaidOut?"css":this.options.isAnimated?"animate":"css";e=this.options.animationOptions;for(h=0,f=this.styleQueue.length;h<f;h++)g=this.styleQueue[h],
g.$el[d](g.style,e);this.styleQueue=[];b&&b.call(a);this.isLaidOut=true},_getColumns:function(){var a=(this.options.isFitWidth?this.element.parent():this.element).width();this.columnWidth=this.options.columnWidth||this.$bricks.outerWidth(true)||a;this.columnWidth+=this.options.gutterWidth;this.cols=Math.floor((a+this.options.gutterWidth)/this.columnWidth);this.cols=Math.max(this.cols,1)},_placeBrick:function(a,b){for(var d=Math.min.apply(Math,b),e=0,c=0,f=b.length;c<f;c++)if(b[c]===d){e=c;break}c=
{top:d};c[this.horizontalDirection]=this.columnWidth*e+this.offset.x;this.styleQueue.push({$el:a,style:c});d+=a.outerHeight(true);this.colYs[e]=d},resize:function(){var a=this.cols;this._getColumns("masonry");this.cols!==a&&this._reLayout()},_reLayout:function(a){if(this.options.colOffsetY)this.colYs=this.options.colOffsetY;else{var b=this.cols;for(this.colYs=[];b--;)this.colYs.push(this.offset.y)}this.layout(this.$bricks,a)},reloadItems:function(){this.$bricks=this._getBricks(this.element.children())},
reload:function(a){this.reloadItems();this._init(a)},appended:function(a,b,d){if(b){this._filterFindBricks(a).css({top:this.element.height()});var c=this;setTimeout(function(){c._appended(a,d)},1)}else this._appended(a,d)},_appended:function(a,b){var d=this._getBricks(a);this.$bricks=this.$bricks.add(d);this.layout(d,b)},remove:function(a){this.$bricks=this.$bricks.not(a);a.remove()},destroy:function(){this.$bricks.removeClass("masonry-brick").each(function(){this.style.position="";this.style.top=
"";this.style.left=""});for(var a=this.element[0].style,b=0,d=f.length;b<d;b++){var e=f[b];a[e]=this.originalStyle[e]}this.element.unbind(".masonry").removeClass("masonry").removeData("masonry");c(n).unbind(".masonry")},getProperty:function(a,b){var d=this[a]||null;b!==o&&c.isFunction(b)&&b.call(null,d)}};c.fn.imagesLoaded=function(a){function b(){a.call(f,e)}function d(){if(!c.browser.msie&&this.height==1)return false;c(this).css("height",this.height||"auto");--g<=0&&this.src!==j&&(setTimeout(b),
e.unbind("load error",d))}var e=this.find("img"),g=e.length,f=this,j="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";g||b();e.bind("load error",d).each(function(){if(this.complete||this.complete===o){var a=this.src;this.src=j;this.src=a}});return this};var p=function(a){this.console&&console.error(a)};c.fn.masonry=function(a){if(typeof a==="string"){var b=Array.prototype.slice.call(arguments,1);this.each(function(){var d=c.data(this,"masonry");d?!c.isFunction(d[a])||a.charAt(0)===
"_"?p("no such method '"+a+"' for masonry instance"):d[a].apply(d,b):p("cannot call methods on masonry prior to initialization; attempted to call method '"+a+"'")})}else this.each(function(){var b=c.data(this,"masonry");b?(b.option(a||{}),b._init()):c.data(this,"masonry",new c.Mason(a,this))});return this}})(window,jQuery);
