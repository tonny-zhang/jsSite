(function(a){a.widget("ui.multiselect",{_version:0.1,version:function(){return this._version},options:{label:"-- Select --",minWidth:200,maxWidth:null,scroll:0},items:[],_create:function(){var b=this,c=b.element.hide(),e=b.items=c.children("option").map(function(){return{label:a(this).text(),value:a(this).text(),option:this}}).get(),d=b.input=a('<div class="ui-multiselect-input" />').attr({tabIndex:-1}).html('<span class="ui-multiselect-label" style="display: inline-block; margin: 2px; padding: 1px;">'+
b.options.label+"</span>").insertAfter(c).autocomplete({delay:0,minLength:0,source:function(b,c){var d=[];a.each(e,function(b,a){a.option.selected||d.push(a)});c(d)},select:function(c,d){a.each(e,function(a,c){d.item.option===c.option&&b.select(a)})}}).addClass("ui-widget ui-widget-content ui-corner-left").css({display:"inline-block",minWidth:b.options.minWidth,maxWidth:b.options.maxWidth||"auto",padding:1,verticalAlign:"middle"}).click(function(){b.button.trigger("click")});b.button=a("<button>").insertAfter(d).button({icons:{primary:"ui-icon-triangle-1-s"},
text:false}).removeClass("ui-corner-all").addClass("ui-corner-right").css({height:d.outerHeight(),verticalAlign:"middle"}).click(function(){d.autocomplete("widget").is(":visible")?d.autocomplete("close"):(a(this).blur(),d.autocomplete("search",""),d.focus())});b.options.scroll&&a(".ui-autocomplete").css({maxHeight:b.options.scroll,overflowY:"auto",overflowX:"hidden",paddingRight:"20px"})},destroy:function(){this.input.remove();this.button.remove();this.element.show();a.Widget.prototype.destroy.call(this)},
select:function(b){var c=this,e=c.items[b];e.option.selected=true;a('<span class="ui-multiselect-item">'+e.label+"</span>").button({icons:{secondary:"ui-icon-close"}}).css({cursor:"default",margin:2}).children(".ui-button-text").css({lineHeight:"normal",paddingTop:0,paddingBottom:0,paddingLeft:".5em"}).end().children(".ui-icon-close").css({cursor:"pointer"}).click(function(){a(this).parent().remove();c.deselect(e);return false}).end().appendTo(c.input);c.input.children(".ui-multiselect-label").hide()},
deselect:function(a){a.option.selected=false;this.input.children(".ui-multiselect-item").length||this.input.children(".ui-multiselect-label").show()}})})(jQuery);
